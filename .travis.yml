language: python
sudo: false
dist: trusty

python:
- '2.7'
- '3.5'


cache: apt

addons:
  apt:
    packages:
    - libopenblas-dev
    - liblapack-dev
    - gfortran


before_install:
- wget http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh -O miniconda.sh
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- conda update --yes conda
- conda config --add channels jochym

install:
- conda install --yes python=$TRAVIS_PYTHON_VERSION pip numpy python-ase spglib scipy
- git describe --tags --dirty
- python setup.py install

script: python test/test_elastic.py

deploy:
  # testing testpypi
  - provider: pypi
    skip_cleanup: true
    server: https://testpypi.python.org/pypi
    user: jochym
    password:
        secure: F9G5InFVXYHzx7Vh42P/kkV4ivB3OzPCY/jKj4zyK2Qzbo1Ss7xrFhk4b/PzWzq5JHQVPQ79Ox5gMicfGLCP5ZiTlPjNIlEhc7NcAQ7hjTh/bMS/0BzloQcg9Z4UzzXfgSGTPNwYJQZyYVLg+256sBuJLYogO2WebVRlIp6uqateV6rdsn5GxiivrvuZnzNgQ7Hj/z8fosPT1OptFks8WvIai1Bani8Mk3fqsOF1cOE60OgwwntnIRXFOvI8knmZcA4a6gpi0XYVarFvGeK1Olab6+VTzlDllDg4gfLxM+Db34SLFhUe7Nt/WyyDR0l+z9ZvSVwvoe/UG2eDAFkDwoNWHA4MSPAAeSHBc1se+vd7ZFAmvK33sqGykWCLz46xbB6O4/tcjwlrQ1BFKImLSsLaKpc4zdm2nytkx5rPC2504FsxGbr/WIUr4l3ieqCrzIuZ7/uQcnapQO5mT4xSjE+7MZ5x0+1FP4oonIJjrUSV1o8bafE08u6PdhQKFB4l4JlYJKw3WFMP/uI9mMewsszlcQZ39UW1UScuFRSUwn9ES3yyIO8drsSFECCZLsOQgf1yq3G94fdA2VuxJ3lwuSiELh2y3otf54khki668wISPNB4uF3nWwFRfZnXoiNvuG4njl4lleVgalBE2XvC6uFm486iyiudWHOSGy4cB2w=
    on:
        branch: rc
        tags: false
        python: 2.7
  # testing anaconda
  - provider: script
    skip_cleanup: true
    script: anaconda -t $ANACONDA_TOKEN build trigger --test-only --branch rc jochym/Elastic
    on:
        branch: rc
        tags: false
        python: 2.7
  # Production pypi
  - provider: pypi
    skip_cleanup: true
    user: jochym
    password:
        secure: a0PJM114WOEhzABWNq7ZCIZfmm6h1qv21X3IZ1cSU8fW+8PDN4wmh08qY/BNloE0o/qvifD68TyBDqfdUpQvaEp7Dpm4dWC6MCqv7JqUc5N3rtkgztjsHw7z2LK32npC+KWtq38jZ/4aJVIHOgNPz54sddtgyq/f8OwgTh9Wx2EKmi1m/TRDBBvYTCHoBQX2fU9wqxZHklWUZJjl6DyxJdszWdefk7l7dzlQhyWK43Gw5K9sTJsPGQZhknC8xG1ce2C9bgciWFRKuwuedhcR8ro3cTChbT3bQm9yICQvUO8evOacDHV3TwwRi8k+kbIi4KFsvmGwvM0dYCZJ2FaD5zQ9ztPfnMy5G295Sn6kCVeRedaOoIi1Xj3NGQtIqlsrfIu2cG8XSr+Sv2FINMcYar4bMZtqygXfpv5LQF88iMBQXFFKhDoPKUWywo5mozeIwW+kNsNWx6mQdbXC6nCDd/rakGYNMNXeJJ0203M10GdIga+Ir+UtcFfoLHDoqXQsONrsKcNmpny+tHC5u1x6j1WczhkNKzhxl5w54+x0BmE2SlKPS5WgDdmh1OKPlRy5tzIHm2Q8CFBdkwfaKF4mcwYAkHKG8keP2qVW0qQkbI8uinQeSbV/1+pUBkFNxYqp2Csi2tVf9cllIEb13WCCqYgjNElhJR1SJ90Oom8X2ts=
    on:
        branch: master
        tags: false
        python: 2.7
  # production anaconda
  - provider: script
    skip_cleanup: true
    script: anaconda -t $ANACONDA_TOKEN build trigger --branch master jochym/Elastic
    on:
        branch: master
        tags: false
        python: 2.7

